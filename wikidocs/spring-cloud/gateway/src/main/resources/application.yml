server:
  port: 8080 # ?????? MSA? ?? ??? 8080?? ??

spring:
  application:
    name: gateway-service # ??? ?? ??

  cloud:
    gateway:
      server:
        webflux:
          httpclient: # ?? ???? ??? ?? ?? ?? (?? : ms)
            response-timeout: 5000 # 5? ?? ??? ?? ??? ?? ??
            connect-timeout: 1000  # ?? ?? ?? (?? ??? ???? ??? ?? ??)
          default-filters: # ?? ???? ????? ??? ??
            - AuthenticationFilter # 'Filter' ???? ???? ?????? ??
          routes:  # ??? ?? ?? (routes? List ??)
            # --- ?? ??? ??? ---
                    - id: member-service-route # ? ??? ?? ID

                      # ? ???? ????? ??? ??? ??? URI
                      # (?: ??? ????. ??? ??? ?????? ?? 'lb://MEMBER-SERVICE'? ?? ??)
                      uri: http://localhost:8081

                      # ? ???? ??? ?? (Predicates)
                      predicates:
                        - Path=/api/v1/members/** # /api/v1/members/? ???? ?? ??

                      # ?? ????? ???? ?? (?? ????? ?? ?)
                      # ?? ???? ???? ???? ?? ?? ???? ??
                        # ?????? ?? member-service? ???? member-service? ?? ??? 'X-Request-Source: gateway-service' ? ??? ?? ??? ?? ?
                        # ??? ?????? ?? ???? 'X-Response-Source: gateway-service' ? ??? ? ??
                      # name: ?? ??, args: ??? ??? ?? (key:value)
                      filters:
                        - name: AddRequestHeader
                        - args:
                            name : X-Request-Source # ??? key
                            value : gateway-service # ??? value

                        # ???(??)
                        - AddResponseHeader=X-Response-Source, gateway-service

                    # --- ?? ??? ??? ---
                    - id: product-service-route
                      uri: http://localhost:8082
                      predicates:
                        - Path=/api/v1/products/**

                    # --- ?? ??? ??? ---
                    - id: order-service-route
                      uri: http://localhost:8083
                      predicates:
                        - Path=/api/v1/orders/**


# ?? ??????? ????? ?? ??
jwt:
  secret: 'a_very_long_and_secure_secret_key_for_ecommerce_project_that_is_at_least_256_bits_long'

security:
  required-roles:
    - path: /api/v1/admin/**
      role: ADMIN
    - path: /api/v1/orders/**
      role: USER